const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["strapi-Cxs8f-5s.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{r as h,ad as v,cE as I,at as _,J as T,cF as D,bD as A,a5 as C,u as N,s as U,aU as B,bR as F,j as t,cG as d,bs as O,cH as R,o as G,af as H,aQ as K,d as M,aV as V,L as $,cI as J}from"./strapi-Cxs8f-5s.js";import{s as Q}from"./sortBy-D98bP1Ss.js";import{s as W}from"./selectors-h6TXpg4U.js";import"./_baseMap-BL0ibkVF.js";import"./_baseEach-CfTPjjLq.js";const Z=i=>i.map(a=>{const o=a.links.map(n=>({...n,isDisplayed:!1}));return{...a,links:o}}),q=()=>{const[{isLoading:i,menu:a},o]=h.useState({isLoading:!0,menu:[]}),n=v("useSettingsMenu",s=>s.checkUserHasPermissions),u=I("useSettingsMenu",s=>s.shouldUpdateStrapi),m=_("useSettingsMenu",s=>s.settings),g=T(W),y=h.useMemo(()=>D(),[]),{admin:p,global:r}=A(y,async()=>(await C(async()=>{const{SETTINGS_LINKS_EE:s}=await import("./strapi-Cxs8f-5s.js").then(e=>e.iZ);return{SETTINGS_LINKS_EE:s}},__vite__mapDeps([0,1]))).SETTINGS_LINKS_EE(),{combine(s,e){return{admin:[...e.admin,...s.admin],global:[...s.global,...e.global]}},defaultValue:{admin:[],global:[]}}),l=h.useCallback(s=>{if(!s.id)throw new Error("The settings menu item must have an id attribute.");return{...s,permissions:g.settings?.[s.id]?.main??[]}},[g.settings]);return h.useEffect(()=>{const s=async()=>{const P=await(L=>Promise.all(L.reduce((f,S,x)=>{const k=S.links.map(async(j,b)=>({hasPermission:(await n(j.permissions)).length>0,sectionIndex:x,linkIndex:b}));return[...f,...k]},[])))(E);o(L=>({...L,isLoading:!1,menu:E.map((f,S)=>({...f,links:f.links.map((x,k)=>{const j=P.find(b=>b.sectionIndex===S&&b.linkIndex===k);return{...x,isDisplayed:!!j?.hasPermission}})}))}))},{global:e,...w}=m,E=Z([{...e,links:Q([...e.links,...r.map(l)],c=>c.id).map(c=>({...c,hasNotification:c.id==="000-application-infos"&&u}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:p.map(l)},...Object.values(w)]);s()},[p,r,m,u,l,n]),{isLoading:i,menu:a.map(s=>({...s,links:s.links.filter(e=>e.isDisplayed)}))}},z=G(H)`
  border-radius: 50%;
  padding: ${({theme:i})=>i.spaces[2]};
  height: 2rem;
`,X=({menu:i})=>{const{formatMessage:a}=N(),{trackUsage:o}=U(),{pathname:n}=B(),{license:u}=F(),m=u?.features.map(s=>s.name),g={"content-releases":"cms-content-releases","review-workflows":"review-workflows",sso:"sso",auditLogs:"audit-logs","auditLogs-purchase-page":"audit-logs"},p=i.filter(s=>!s.links.every(e=>e.isDisplayed===!1)).map(s=>({...s,title:s.intlLabel,links:s.links.map(e=>({...e,id:e.id,title:e.intlLabel,name:e.id}))})),r=a({id:"global.settings",defaultMessage:"Settings"}),l=s=>()=>{o("willNavigate",{from:n,to:s})};return t.jsxs(d.Main,{"aria-label":r,children:[t.jsx(d.Header,{label:r}),t.jsx(O,{background:"neutral150",marginBottom:5}),t.jsx(d.Sections,{children:p.map(s=>t.jsx(d.Section,{label:a(s.intlLabel),children:s.links.map(e=>t.jsx(d.Link,{to:e.to,onClick:l(e.to),label:a(e.intlLabel),endAction:t.jsxs(t.Fragment,{children:[e?.licenseOnly&&t.jsx(R,{fill:(m||[]).includes(g[e.id])?"primary600":"neutral300",width:"1.5rem",height:"1.5rem"}),e?.hasNotification&&t.jsx(z,{"aria-label":"Notification",backgroundColor:"primary600",textColor:"neutral0",children:"1"})]})},e.id))},s.id))})]})},is=()=>{const i=K("/settings/:settingId/*"),{formatMessage:a}=N(),{isLoading:o,menu:n}=q();return o?t.jsx(M.Loading,{}):i?.params.settingId?t.jsxs($.Root,{sideNav:t.jsx(X,{menu:n}),children:[t.jsx(M.Title,{children:a({id:"global.settings",defaultMessage:"Settings"})}),t.jsx(J,{})]}):t.jsx(V,{to:"application-infos"})};export{is as Layout};
