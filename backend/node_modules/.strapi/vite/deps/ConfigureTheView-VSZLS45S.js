import {
  useConfig
} from "./chunk-DX4T3VF2.js";
import {
  getTrad,
  pageSizes,
  pluginId,
  sortOptions
} from "./chunk-LZEGSNAG.js";
import "./chunk-WS4NBQP7.js";
import "./chunk-P2RTLUGO.js";
import "./chunk-YCAWQGXI.js";
import "./chunk-6ZZNC6KH.js";
import "./chunk-XR2TPJJN.js";
import "./chunk-CYUO7FL7.js";
import "./chunk-SWD7HKJO.js";
import "./chunk-4W3OO4IH.js";
import "./chunk-QIJGNK42.js";
import "./chunk-R7HEAKUN.js";
import "./chunk-NTF6YBGM.js";
import "./chunk-XDPMCWEQ.js";
import "./chunk-AKZSQR2T.js";
import "./chunk-PDOCLNCK.js";
import "./chunk-3U6PS7YQ.js";
import "./chunk-VODNMJFC.js";
import "./chunk-ETJ6P3HJ.js";
import "./chunk-CZEWOCNY.js";
import "./chunk-KIW6APWY.js";
import "./chunk-B3M52OQC.js";
import "./chunk-IBYRPVC7.js";
import "./chunk-ROXU537S.js";
import {
  ConfirmDialog
} from "./chunk-S4AL3GV7.js";
import "./chunk-2ZLL6DD2.js";
import "./chunk-44ADQSDE.js";
import "./chunk-K45EVBK5.js";
import "./chunk-MBK4V2X7.js";
import {
  require_set
} from "./chunk-YDTXDZ2Q.js";
import "./chunk-3ZONBOKZ.js";
import "./chunk-K65KIEAL.js";
import "./chunk-CNFWPOPO.js";
import "./chunk-P2PSSEAT.js";
import "./chunk-OCXEABBQ.js";
import "./chunk-77LOGOXU.js";
import "./chunk-D4WYVNVM.js";
import "./chunk-MMOBCIZG.js";
import "./chunk-IFOFBKTA.js";
import "./chunk-JEQEPTUK.js";
import "./chunk-EGNP2T5O.js";
import "./chunk-IV6RKRFF.js";
import {
  Layouts
} from "./chunk-4UYY5MP5.js";
import {
  useTracking
} from "./chunk-YIA2BFSF.js";
import "./chunk-ZOZRZF6A.js";
import "./chunk-YXDCVYVT.js";
import "./chunk-PQINNV4N.js";
import {
  require_isEqual
} from "./chunk-VYSYYPOB.js";
import {
  Page
} from "./chunk-J2PFNBDN.js";
import "./chunk-GISP7OGO.js";
import "./chunk-E5KWVS2H.js";
import {
  useNotification
} from "./chunk-IBZCKHK5.js";
import {
  require_get,
  require_lib
} from "./chunk-LMV7ZQ6O.js";
import "./chunk-VHSA2XKI.js";
import "./chunk-BHLYCXQ7.js";
import "./chunk-R47JF2WO.js";
import "./chunk-CE4VABH2.js";
import {
  fn
} from "./chunk-QOUV5O5E.js";
import {
  Box,
  Button,
  Dialog,
  Field,
  Grid,
  Link,
  SingleSelect,
  SingleSelectOption,
  useIntl
} from "./chunk-65K7KNUE.js";
import {
  NavLink
} from "./chunk-S65ZWNEO.js";
import {
  ForwardRef$4N,
  ForwardRef$5r
} from "./chunk-KWJWDXSR.js";
import {
  require_jsx_runtime
} from "./chunk-NIAJZ5MX.js";
import "./chunk-5ZC4PE57.js";
import "./chunk-FOD4ENRR.js";
import "./chunk-2D5XVQ5Y.js";
import {
  require_react
} from "./chunk-MADUDGYZ.js";
import {
  __toESM
} from "./chunk-PLDDJCW6.js";

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/ConfigureTheView.mjs
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
var React = __toESM(require_react(), 1);
var import_isEqual = __toESM(require_isEqual(), 1);
var import_qs2 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/components/Settings.mjs
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var import_qs = __toESM(require_lib(), 1);
var Settings = ({ sort = "", pageSize = 10, onChange: onChange2 }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime.jsx)(Box, {
    background: "neutral0",
    hasRadius: true,
    shadow: "tableShadow",
    paddingTop: 6,
    paddingBottom: 6,
    paddingLeft: 7,
    paddingRight: 7,
    children: (0, import_jsx_runtime.jsxs)(Grid.Root, {
      gap: 4,
      children: [
        (0, import_jsx_runtime.jsx)(Grid.Item, {
          s: 12,
          col: 6,
          direction: "column",
          alignItems: "stretch",
          children: (0, import_jsx_runtime.jsxs)(Field.Root, {
            hint: formatMessage({
              id: getTrad("config.entries.note"),
              defaultMessage: "Number of assets displayed by default in the Media Library"
            }),
            name: "pageSize",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, {
                children: formatMessage({
                  id: getTrad("config.entries.title"),
                  defaultMessage: "Entries per page"
                })
              }),
              (0, import_jsx_runtime.jsx)(SingleSelect, {
                onChange: (value) => onChange2({
                  target: {
                    name: "pageSize",
                    value
                  }
                }),
                value: pageSize,
                children: pageSizes.map((pageSize2) => (0, import_jsx_runtime.jsx)(SingleSelectOption, {
                  value: pageSize2,
                  children: pageSize2
                }, pageSize2))
              }),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          })
        }),
        (0, import_jsx_runtime.jsx)(Grid.Item, {
          s: 12,
          col: 6,
          direction: "column",
          alignItems: "stretch",
          children: (0, import_jsx_runtime.jsxs)(Field.Root, {
            hint: formatMessage({
              id: getTrad("config.note"),
              defaultMessage: "Note: You can override this value in the media library."
            }),
            name: "sort",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, {
                children: formatMessage({
                  id: getTrad("config.sort.title"),
                  defaultMessage: "Default sort order"
                })
              }),
              (0, import_jsx_runtime.jsx)(SingleSelect, {
                onChange: (value) => onChange2({
                  target: {
                    name: "sort",
                    value
                  }
                }),
                value: sort,
                "test-sort": sort,
                "data-testid": "sort-select",
                children: sortOptions.map((filter) => (0, import_jsx_runtime.jsx)(SingleSelectOption, {
                  "data-testid": `sort-option-${filter.value}`,
                  value: filter.value,
                  children: formatMessage({
                    id: getTrad(filter.key),
                    defaultMessage: `${filter.value}`
                  })
                }, filter.key))
              }),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          })
        })
      ]
    })
  });
};

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/actionTypes.mjs
var ON_CHANGE = `${pluginId}/ON_CHANGE`;
var SET_LOADED = `${pluginId}/SET_LOADED`;

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/actions.mjs
var onChange = ({ name, value }) => ({
  type: ON_CHANGE,
  keys: name,
  value
});
var setLoaded = () => ({
  type: SET_LOADED
});

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/init.mjs
var initialState = {
  initialData: {},
  modifiedData: {}
};
var init = (configData) => {
  return {
    ...initialState,
    initialData: configData,
    modifiedData: configData
  };
};

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/reducer.mjs
var import_get = __toESM(require_get(), 1);
var import_set = __toESM(require_set(), 1);
var reducer = (state = initialState, action = {
  type: ""
}) => (
  // eslint-disable-next-line consistent-return
  fn(state, (draftState) => {
    switch (action.type) {
      case ON_CHANGE: {
        if ("keys" in action && "value" in action && action.keys) {
          (0, import_set.default)(draftState, [
            "modifiedData",
            ...action.keys.split(".")
          ], action.value);
        }
        break;
      }
      case SET_LOADED: {
        const reInitialise = init((0, import_get.default)(draftState, [
          "modifiedData"
        ], {}));
        draftState.initialData = reInitialise.initialData;
        draftState.modifiedData = reInitialise.modifiedData;
        break;
      }
      default:
        return draftState;
    }
  })
);

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/ConfigureTheView.mjs
var ConfigureTheView = ({ config }) => {
  const { trackUsage } = useTracking();
  const { formatMessage } = useIntl();
  const { toggleNotification } = useNotification();
  const { mutateConfig } = useConfig();
  const { isLoading: isSubmittingForm } = mutateConfig;
  const [showWarningSubmit, setWarningSubmit] = React.useState(false);
  const toggleWarningSubmit = () => setWarningSubmit((prevState) => !prevState);
  const [reducerState, dispatch] = React.useReducer(reducer, initialState, () => init(config));
  const typedDispatch = dispatch;
  const { initialData, modifiedData } = reducerState;
  const handleSubmit = (e) => {
    e.preventDefault();
    toggleWarningSubmit();
  };
  const handleConfirm = async () => {
    trackUsage("willEditMediaLibraryConfig");
    await mutateConfig.mutateAsync(modifiedData);
    setWarningSubmit(false);
    typedDispatch(setLoaded());
    toggleNotification({
      type: "success",
      message: formatMessage({
        id: "notification.form.success.fields",
        defaultMessage: "Changes saved"
      })
    });
  };
  const handleChange = ({ target: { name, value } }) => {
    typedDispatch(onChange({
      name,
      value
    }));
  };
  return (0, import_jsx_runtime2.jsx)(Layouts.Root, {
    children: (0, import_jsx_runtime2.jsx)(Page.Main, {
      "aria-busy": isSubmittingForm,
      children: (0, import_jsx_runtime2.jsxs)("form", {
        onSubmit: handleSubmit,
        children: [
          (0, import_jsx_runtime2.jsx)(Layouts.Header, {
            navigationAction: (0, import_jsx_runtime2.jsx)(Link, {
              tag: NavLink,
              startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$5r, {}),
              to: `/plugins/${pluginId}`,
              id: "go-back",
              children: formatMessage({
                id: getTrad("config.back"),
                defaultMessage: "Back"
              })
            }),
            primaryAction: (0, import_jsx_runtime2.jsx)(Button, {
              size: "S",
              startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$4N, {}),
              disabled: (0, import_isEqual.default)(modifiedData, initialData),
              type: "submit",
              children: formatMessage({
                id: "global.save",
                defaultMessage: "Save"
              })
            }),
            subtitle: formatMessage({
              id: getTrad("config.subtitle"),
              defaultMessage: "Define the view settings of the media library."
            }),
            title: formatMessage({
              id: getTrad("config.title"),
              defaultMessage: "Configure the view - Media Library"
            })
          }),
          (0, import_jsx_runtime2.jsx)(Layouts.Content, {
            children: (0, import_jsx_runtime2.jsx)(Settings, {
              "data-testid": "settings",
              pageSize: modifiedData.pageSize || "",
              sort: modifiedData.sort || "",
              onChange: handleChange
            })
          }),
          "x",
          (0, import_jsx_runtime2.jsx)(Dialog.Root, {
            open: showWarningSubmit,
            onOpenChange: toggleWarningSubmit,
            children: (0, import_jsx_runtime2.jsx)(ConfirmDialog, {
              onConfirm: handleConfirm,
              variant: "default",
              children: formatMessage({
                id: getTrad("config.popUpWarning.warning.updateAllSettings"),
                defaultMessage: "This will modify all your settings"
              })
            })
          })
        ]
      })
    })
  });
};
export {
  ConfigureTheView
};
//# sourceMappingURL=ConfigureTheView-VSZLS45S.js.map
