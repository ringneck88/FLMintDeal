{"version":3,"file":"bootstrap.js","sources":["../../server/src/bootstrap.ts"],"sourcesContent":["import type { Core } from '@strapi/types';\n\nimport { getService } from './utils';\n\n// Add permissions\nconst RBAC_ACTIONS = [\n  {\n    section: 'plugins',\n    displayName: 'Access the Documentation',\n    uid: 'read',\n    pluginName: 'documentation',\n  },\n  {\n    section: 'plugins',\n    displayName: 'Update and delete',\n    uid: 'settings.update',\n    pluginName: 'documentation',\n  },\n  {\n    section: 'plugins',\n    displayName: 'Regenerate',\n    uid: 'settings.regenerate',\n    pluginName: 'documentation',\n  },\n  {\n    section: 'settings',\n    displayName: 'Access the documentation settings page',\n    uid: 'settings.read',\n    pluginName: 'documentation',\n    category: 'documentation',\n  },\n];\n\nexport async function bootstrap({ strapi }: { strapi: Core.Strapi }) {\n  await strapi.service('admin::permission').actionProvider.registerMany(RBAC_ACTIONS);\n\n  const pluginStore = strapi.store!({\n    environment: '',\n    type: 'plugin',\n    name: 'documentation',\n  });\n\n  const config = await pluginStore.get({ key: 'config' });\n\n  if (!config) {\n    pluginStore.set({ key: 'config', value: { restrictedAccess: false } });\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    await getService('documentation').generateFullDoc();\n  }\n}\n"],"names":["RBAC_ACTIONS","section","displayName","uid","pluginName","category","bootstrap","strapi","service","actionProvider","registerMany","pluginStore","store","environment","type","name","config","get","key","set","value","restrictedAccess","process","env","NODE_ENV","getService","generateFullDoc"],"mappings":";;;;AAIA;AACA,MAAMA,YAAe,GAAA;AACnB,IAAA;QACEC,OAAS,EAAA,SAAA;QACTC,WAAa,EAAA,0BAAA;QACbC,GAAK,EAAA,MAAA;QACLC,UAAY,EAAA;AACd,KAAA;AACA,IAAA;QACEH,OAAS,EAAA,SAAA;QACTC,WAAa,EAAA,mBAAA;QACbC,GAAK,EAAA,iBAAA;QACLC,UAAY,EAAA;AACd,KAAA;AACA,IAAA;QACEH,OAAS,EAAA,SAAA;QACTC,WAAa,EAAA,YAAA;QACbC,GAAK,EAAA,qBAAA;QACLC,UAAY,EAAA;AACd,KAAA;AACA,IAAA;QACEH,OAAS,EAAA,UAAA;QACTC,WAAa,EAAA,wCAAA;QACbC,GAAK,EAAA,eAAA;QACLC,UAAY,EAAA,eAAA;QACZC,QAAU,EAAA;AACZ;AACD,CAAA;AAEM,eAAeC,SAAAA,CAAU,EAAEC,MAAM,EAA2B,EAAA;AACjE,IAAA,MAAMA,OAAOC,OAAO,CAAC,qBAAqBC,cAAc,CAACC,YAAY,CAACV,YAAAA,CAAAA;IAEtE,MAAMW,WAAAA,GAAcJ,MAAOK,CAAAA,KAAK,CAAE;QAChCC,WAAa,EAAA,EAAA;QACbC,IAAM,EAAA,QAAA;QACNC,IAAM,EAAA;AACR,KAAA,CAAA;AAEA,IAAA,MAAMC,MAAS,GAAA,MAAML,WAAYM,CAAAA,GAAG,CAAC;QAAEC,GAAK,EAAA;AAAS,KAAA,CAAA;AAErD,IAAA,IAAI,CAACF,MAAQ,EAAA;AACXL,QAAAA,WAAAA,CAAYQ,GAAG,CAAC;YAAED,GAAK,EAAA,QAAA;YAAUE,KAAO,EAAA;gBAAEC,gBAAkB,EAAA;AAAM;AAAE,SAAA,CAAA;AACtE;AACA,IAAA,IAAIC,OAAQC,CAAAA,GAAG,CAACC,QAAQ,KAAK,YAAc,EAAA;QACzC,MAAMC,gBAAAA,CAAW,iBAAiBC,eAAe,EAAA;AACnD;AACF;;;;"}